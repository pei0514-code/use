
<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>麥麥商城票券使用說明</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
      body {
        font-family: 'Noto Sans TC', sans-serif;
        -webkit-tap-highlight-color: transparent;
      }
      .brand-card {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      .brand-card:active {
        transform: scale(0.95);
      }
      .animate-fade-in {
        animation: fadeIn 0.5s ease-out forwards;
      }
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
    </style>
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@^19.2.3",
        "react/": "https://esm.sh/react@^19.2.3/",
        "react-dom/client": "https://esm.sh/react-dom@^19.2.3/client"
      }
    }
    </script>
  </head>
  <body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script type="module">
      import React, { useState, useEffect } from 'react';
      import ReactDOM from 'react-dom/client';

      // --- 定義與常數 ---
      const Brand = {
        MCDONALDS: 'MCDONALDS',
        STARBUCKS: 'STARBUCKS',
        KFC: 'KFC',
        PIZZAHUT: 'PIZZAHUT'
      };

      const BRAND_CONFIG = {
        [Brand.MCDONALDS]: { name: '麥當勞', icon: '🍔', color: 'bg-red-600' },
        [Brand.STARBUCKS]: { name: '星巴克', icon: '☕', color: 'bg-green-800' },
        [Brand.KFC]: { name: '肯德基', icon: '🍗', color: 'bg-red-700' },
        [Brand.PIZZAHUT]: { name: '必勝客', icon: '🍕', color: 'bg-orange-600' }
      };

      const MOCK_PRODUCTS = [
        { id: '1', name: '大麥克雙層牛肉堡', brand: Brand.MCDONALDS },
        { id: '2', name: '10塊麥克雞塊餐', brand: Brand.MCDONALDS },
        { id: '3', name: '那堤大杯(冰/熱)', brand: Brand.STARBUCKS },
        { id: '4', name: '咔啦脆雞(中辣)', brand: Brand.KFC },
        { id: '5', name: '6吋個人鬆厚比薩', brand: Brand.PIZZAHUT },
        { id: '6', name: '薯條(大)', brand: Brand.MCDONALDS },
        { id: '7', name: '經典美式咖啡', brand: Brand.STARBUCKS },
        { id: '8', name: '上校雞塊(8塊)', brand: Brand.KFC },
      ];

      // --- 子組件：品牌說明內容 ---
      const BrandInstructions = ({ brand }) => {
        if (brand === Brand.MCDONALDS) {
          return (
            <div className="space-y-4 text-sm">
              <section>
                <h4 className="font-bold text-red-600 flex items-center">🍟 櫃台使用</h4>
                <p className="pl-6 mt-1 text-slate-600">告知店員欲使用電子商品券，並提供<span className="font-bold text-red-500 underline">截圖</span>給店員掃描。</p>
              </section>
              <section>
                <h4 className="font-bold text-red-600 flex items-center">🚗 得來速使用</h4>
                <p className="pl-6 mt-1 text-slate-600">告知點餐對講機欲使用電子商品券，再到下一窗口掃描截圖。</p>
              </section>
              <section className="bg-red-50 p-4 rounded-2xl border border-red-100">
                <h4 className="font-bold text-red-600 flex items-center">🖥️ 自助點餐機 (推薦)</h4>
                <ul className="pl-6 mt-1 space-y-1 list-decimal text-slate-600">
                  <li>點選開始 → 選擇用餐方式 (外帶/內用)</li>
                  <li>左上角選「<span className="font-bold">電子商品卷</span>」</li>
                  <li>打開截圖放在掃描區進行感應</li>
                  <li>確認餐點（可特製去冰等）</li>
                  <li><span className="text-red-700 font-medium">每次最多掃5張，可重複多次兌換</span></li>
                </ul>
              </section>
            </div>
          );
        }
        if (brand === Brand.KFC) {
          return (
            <div className="space-y-4 text-sm">
              <section>
                <h4 className="font-bold text-red-700">🌐 官網兌換 (最方便)</h4>
                <p className="pl-4 mt-1 text-slate-600">至肯德基官網「優惠券」區輸入序號即可兌換。建議使用「預訂快取」專屬通道取餐。</p>
                <a href="https://www.kfcclub.com.tw/Coupon" target="_blank" className="inline-block mt-2 px-3 py-1 bg-red-700 text-white text-xs rounded-full">前往官網兌換</a>
              </section>
              <section>
                <h4 className="font-bold text-red-700">🏪 門市/自助機兌換</h4>
                <p className="pl-4 mt-1 text-slate-600">告知櫃台人員選擇「兌換掃券」按鍵。不接受手抄、口說序號。<span className="text-red-600 font-bold">外送與得來速車道不適用。</span></p>
                <a href="https://www.edenred.com.tw/index.php/store/kfc/" target="_blank" className="text-blue-500 underline text-xs block mt-1 pl-4">查看不適用門市清單</a>
              </section>
            </div>
          );
        }
        if (brand === Brand.PIZZAHUT) {
          return (
            <div className="space-y-4 text-sm">
              <section>
                <h4 className="font-bold text-orange-600">📱 官網 / PK雙響卡 APP</h4>
                <p className="pl-4 mt-1 text-slate-600">選單點選「優惠券兌換」→「輸入電子禮券序號」。輸入 <span className="font-mono bg-slate-100 px-1">VP</span> 開頭之 20 碼序號。</p>
              </section>
              <section>
                <h4 className="font-bold text-orange-600">📞 電話訂餐 (412-9889)</h4>
                <p className="pl-4 mt-1 text-slate-600">告知接線人員欲使用電子禮券，並提供完整 20 碼序號。取餐時請出示截圖。</p>
              </section>
              <section>
                <h4 className="font-bold text-orange-600">🏪 門市現場</h4>
                <p className="pl-4 mt-1 text-slate-600">告知人員選擇「兌換掃券」按鍵，結帳前出示截圖核銷。</p>
              </section>
            </div>
          );
        }
        if (brand === Brand.STARBUCKS) {
          return (
            <div className="space-y-4 text-sm">
              <section>
                <h4 className="font-bold text-green-800">☕ 櫃台掃碼兌換</h4>
                <p className="pl-4 mt-1 text-slate-600">告知店員欲使用電子商品券，開啟手機<span className="font-bold underline">截圖畫面</span>給櫃台人員掃描即可。</p>
              </section>
              <div className="bg-green-50 p-3 rounded-xl border border-green-100 text-xs text-green-800 italic">
                請確保手機亮度調高，以便門市人員順利掃瞄條碼。
              </div>
            </div>
          );
        }
        return null;
      };

      // --- 主程式組件 ---
      const App = () => {
        const [profile, setProfile] = useState({ displayName: 'LINE 會員' });
        const [selectedBrand, setSelectedBrand] = useState(null);
        const [isLiffReady, setIsLiffReady] = useState(false);

        useEffect(() => {
          const init = async () => {
            try {
              // 請在此填入您的 LIFF ID
              await liff.init({ liffId: 'YOUR_LIFF_ID' });
              if (liff.isLoggedIn()) {
                const userProfile = await liff.getProfile();
                setProfile(userProfile);
              }
              setIsLiffReady(true);
            } catch (err) {
              console.error('LIFF Init Error', err);
              setIsLiffReady(true); // 即使失敗也顯示 UI
            }
          };
          init();
        }, []);

        return (
          <div className="min-h-screen max-w-md mx-auto bg-white shadow-xl flex flex-col">
            {/* Header */}
            <header className="bg-gradient-to-br from-red-600 to-orange-500 text-white p-8 rounded-b-[3rem] shadow-lg">
              <div className="animate-fade-in">
                <p className="text-sm opacity-90 mb-1">
                  親愛的 <span className="font-bold underline text-yellow-200">{profile.displayName}</span> 您好
                </p>
                <h1 className="text-2xl font-black tracking-tight">請選擇購買的商品種類</h1>
                <div className="mt-4 h-1 w-12 bg-yellow-400 rounded-full"></div>
              </div>
            </header>

            <main className="px-6 py-8 flex-grow">
              {/* 品牌選擇器 */}
              <div className="grid grid-cols-2 gap-4 mb-8">
                {Object.keys(Brand).map((key) => {
                  const b = Brand[key];
                  const config = BRAND_CONFIG[b];
                  return (
                    <button
                      key={b}
                      onClick={() => setSelectedBrand(b)}
                      className={`brand-card p-5 rounded-3xl border-2 flex flex-col items-center justify-center gap-2 ${
                        selectedBrand === b 
                          ? 'border-red-500 bg-red-50 ring-4 ring-red-100' 
                          : 'border-slate-100 bg-slate-50 hover:border-slate-200'
                      }`}
                    >
                      <span className="text-4xl">{config.icon}</span>
                      <span className="font-bold text-slate-700">{config.name}</span>
                    </button>
                  );
                })}
              </div>

              {/* 說明內容 */}
              {selectedBrand ? (
                <div className="animate-fade-in space-y-6">
                  <div className="bg-white rounded-3xl p-6 border border-slate-100 shadow-sm">
                    <h2 className="text-lg font-black mb-4 flex items-center gap-2">
                      <span className="w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center">📖</span>
                      {BRAND_CONFIG[selectedBrand].name} 使用說明
                    </h2>
                    <BrandInstructions brand={selectedBrand} />
                  </div>

                  {/* 商品參考 */}
                  <div className="bg-slate-50 rounded-3xl p-6 border border-slate-100">
                    <h3 className="text-md font-bold mb-4 flex items-center gap-2 text-slate-500">
                      <span className="text-lg">🛒</span> 熱門兌換商品
                    </h3>
                    <div className="space-y-2">
                      {MOCK_PRODUCTS.filter(p => p.brand === selectedBrand).map(product => (
                        <div key={product.id} className="bg-white p-3 rounded-xl text-sm font-medium border border-slate-100 flex justify-between items-center">
                          {product.name}
                          <span className="text-[10px] bg-slate-100 px-2 py-0.5 rounded-full text-slate-400">電子券</span>
                        </div>
                      ))}
                      <a 
                        href="https://docs.google.com/spreadsheets/d/1HR_0C9BW8ib7dxPG5Iic0K31i0xKk500Dfkvbxhwq5Y/edit?gid=1812571023#gid=1812571023"
                        target="_blank"
                        className="block w-full text-center mt-4 py-3 bg-slate-900 text-white rounded-2xl font-bold text-sm"
                      >
                        查看完整 Google 試算表清單
                      </a>
                    </div>
                  </div>
                </div>
              ) : (
                <div className="text-center py-12 px-8 bg-slate-50 rounded-[2rem] border-2 border-dashed border-slate-200">
                  <p className="text-slate-400 text-sm">👆 請先點選上方的品牌圖示<br/>查看詳細的兌換流程</p>
                </div>
              )}

              {/* 注意事項 */}
              <section className="mt-10 bg-amber-50 rounded-3xl p-6 border border-amber-100">
                <h2 className="text-amber-800 font-bold mb-4 flex items-center gap-2">
                  <span>⚠️</span> 注意事項
                </h2>
                <ul className="text-xs text-amber-900/80 space-y-3 pl-5 list-decimal font-medium">
                  <li>請將以上<span className="text-red-600 font-bold underline">截圖保存</span>下來，期限為取得後約 <span className="text-red-600 font-bold underline">30天內</span> 兌換，請儘速兌換。</li>
                  <li>兌換時再開啟截圖畫面給櫃台人員或機台使用即可。</li>
                  <li>逾期將失效，<span className="text-red-600 font-bold">恕無法補發或退款</span>。</li>
                  <li>每次交易最多可兌換 5 張，可多次重複使用。</li>
                  <li>若序號被鎖定（查詢或取消），請於 <span className="font-bold underline">5分鐘後</span> 再次嘗試。</li>
                </ul>
              </section>
            </main>

            <footer className="p-8 text-center text-[10px] text-slate-300 uppercase tracking-widest">
              Mai Mai Store Ticket Guide © 2024
            </footer>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>
